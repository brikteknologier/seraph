# SERAF.JS

BINDS T TEH REST API OV [NEO4J](HTTP://NEO4J.ORG/). INTENDED T BE
TERSE, SIMPLE, AN IDIOMATIC TO [NODE.JS](HTTP://NODEJS.ORG/).

## QUICK EXAMPLE

```JAVASCRIPT
// INSERT, THEN DELETE AN OBJECT
VAR DB = REQUIRE("SERAF").DB("HTTP://LOCALHOST:7474");
DB.SAVE({ NAME: "TEST-MAN", UJ: 40 }, FUNCSHUN (ERR, DATA) {
   IF (ERR) THROW ERR; CONSOLE.LOG("TEST-MAN INSERTED.");
   DB.NODE.DELETE(DATA, FUNCSHUN (ERR) {
      IF (ERR) THROW ERR; CONSOLE.LOG("TEST-MAN AWAY!");
   }
}
```

## DOCUMENTASHUN

< NAME="SERAF.DB_LIST" />
### GENERIC OPERASHUNS * [DB](#DB)

* [KWEY](#KWEY)
* [RAWKWEY](#RAWKWEY)
* [TRAVERSAL](#TRAVERSAL)

### API COMMUNICASHUN OPERASHUNS

* [OPERASHUN](#OPERASHUN)
* [CALL](#CALL)
* [BATCH](#BATCH) ### NODE OPERASHUNS
* [SAVE (NODE.SAVE)](#NODE.SAVE)
* [REDD (NODE.REDD)](#NODE.REDD)
* [FIN (NODE.FIN)](#NODE.FIN)
* [DELETE (NODE.DELETE)](#NODE.DELETE)
* [RELATE (NODE.RELATE)](#NODE.RELATE)
* [RELASHUNSHIPS (NODE.RELASHUNSHIPS)](#NODE.RELASHUNSHIPS)
* [INDEX (NODE.INDEX)](#NODE.INDEX)
* [INDEXES (NODE.INDEXES)](#NODE.INDEXES)

### RELASHUNSHIP OPERASHUNS

* [REL.SAVE](#REL.SAVE)
* [REL.REDD](#REL.REDD)
* [REL.DELETE](#REL.DELETE)

### INDEX OPERASHUNS

* [INDEX.CREATE](#INDEX.CREATE)
* [INDEX.ADD](#INDEX.ADD)
* [INDEX.REDD](#INDEX.REDD)

YOO CAN ALSO ACCESS ALL FUNCSHUNS DIRECTLY ON `SERAF` (WITHOUT CALLIN `DB()`).
IN THIS CASE YOO MUST SUPPLY AN OPSHUNS ARGUMENT. (SEE [DB](#DB) FOAR CONFIGURASHUN DOCUMENTASHUN). 

SO THIS:

```JAVASCRIPT
VAR SERAF = REQUIRE("SERAF");
VAR DB = SERAF.DB("HTTP://LOCALHOST:7474/");
DB.SAVE({X: 3});
```

COULD ALSO BE WRITTEN LIEK THIS:

```JAVASCRIPT
VAR SERAF = REQUIRE("SERAF");
SERAF.SAVE("HTTP://LOCALHOST:7474/", {X: 3});
```

## MODULE FUNCSHUNS

< NAME="DB" />
### DB (OPSHUNS)

RETURNS AN OBJECT WITH DATABASE ACCESS FUNCSHUNS. SEE
[SERAF.DB](#SERAF.DB_LIST). `OPSHUNS` AR AN OBJECT WITH TEH FOLLOWINS ATTRIBUTES:

* `OPSHUNS.ENDPOINT`: OPSHUNAL. DEFAULT="HTTP://LOCALHOST:7474". URL OF NEO4J REST API.
* `OPSHUNS.ID`: OPSHUNAL. DEFAULT="ID". SAVED OBJECTS WILL HAV THIS PROPERTY SET TO TEH GENERATED DATABASE ID. WHEN UPDATIN OR DELETIN OBJECTS, WILL LOK 4 OBJECT ID IN THIS PROPERTY.

ALTERNATIVELY, `OPSHUNS` CAN JUS BE TEH DATABASE URL AZ STRIN. ---------------------------------------

## `DB` FUNCSHUNS

< NAME="KWEY" />
< NAME="RAWKWEY"/>
### KWEY/RAWKWEY (KWEY, [PARAMS,] CALLBACK)

`RAWKWEY` PERFOARMS CYFR KWEY AN RETURNS TEH RESULTS DIRECTLY FRUM TEH
REST API. `KWEY` PERFOARMS CYFR KWEY AN MAP TEH COLUMNS AN RESULTS TOGETHR.

__ARGUMENTS__

* KWEY - CYFR KWEY AZ FOARMAT STRINS.
* PARAMS - DEFAULT=`{}`. REPLACE `{KEY}` PARTS IN KWEY STRIN. SEE CYFR DOCUMENTASHUN FOAR DETAILS.
* CALLBACK - FUNCSHUN (ERR, RESULT). RESULT AR TEH AN ARRAY OF OBJECTS.

__EXAMPLE__

GIVEN DATABASE: 

```JAVASCRIPT
{ NAME: JON, UJ: 23, ID: 1 }
{ NAME: NEIL, UJ: 60, ID: 2 }
{ NAME: KATIE, UJ: 29, ID: 3 }
// 1 --KNOWS--> 2
// 1 --KNOWS--> 3
```

RETURN ALL PEOPLE JON KNOWS:

```JAVASCRIPT
VAR CYFR = "START X = NODE({ID}) " + "MATCH X -[R]-> N " + "RETURN N " + "ORDR BY N.NAME";
DB.KWEY(CYFR, {ID: 1}, FUNCSHUN(ERR, RESULT) {
   IF (ERR) THROW ERR;
   ASSERT.DEEPEQUAL(RESULT, [ { NAME: KATIE, UJ: 29, ID: 3 }, { NAME: NEIL, UJ: 60, ID: 2 } ]);
};

DB.RAWKWEY(CYFR, {ID: 3}, FUNCSHUN(ERR, RESULT) {
   IF (ERR) THROW ERR;
   // RESULT CONTAINS TEH RAW RESPONSE FRUM NEO4JS REST API. SEE
   // HTTP://DOCS.NEO4J.ORG/CHUNKED/MILESTONE/REST-API-CYFR.HTML
   // FOR MOAR INFO
})
```

__NOTE__: IF YOORE PERFORMNG LARGE KWEIES IT MAY BE ADVANTUJOUS TO USE
`KWEYRAW`, SINCE `KWEY` ATTEMPTS T INFR HOOLE NODES AN RELASHUNSHIPS THAT
R RETURNED (IN ORDR TO TRANSFOARM THEM INTO NICR FOARMAT).

---------------------------------------

< NAME="TRAVERSAL" />
### TRAVERSAL (TRAVERSAL, CALLBACK)

<IMG SRC="HTTP://PLACEKITTEN.COM/200/140">

---------------------------------------

< NAME="OPERASHUN" />
### OPERASHUN (PATH, [METHOD=GET], [DATA])

<IMG SRC="HTTP://PLACEKITTEN.COM/200/140">

---------------------------------------

< NAME="CALL" />
### CALL (OPTS, OPERASHUN, CALLBACK)

<IMG SRC="HTTP://PLACEKITTEN.COM/200/140">

---------------------------------------

< NAME="BATCH" />
### BATCH (BLOCK|OPERASHUNARRAY, CALLBACK)

<IMG SRC="HTTP://PLACEKITTEN.COM/200/140">

---------------------------------------

< NAME="NODE.SAVE" />
### SAVE (OBJECT, CALLBACK)
**ALIASES: __NODE.SAVE__**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/145">

---------------------------------------

< NAME="NODE.REDD" />
### REDD (ID|OBJECT, CALLBACK)
**ALIASES: __NODE.READ__**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/142">

---------------------------------------

< NAME="NODE.DELETE" />
### DELETE (ID|OBJECT, [CALLBACK])
**ALIASES: __NODE.DELETE__**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/140">

---------------------------------------

< NAME="NODE.FIN" />
### FIN (PREDICATE, ANY, CALLBACK)
**ALIASES: __NODE.FIND__**

PERFURM KWEY BASED ON PREDICATE. TEH PREDICATE AR TRANSLATED TO CYFR KWEY.

__ARGUMENTS__

* PREDICATE - PARTIALLY DEFINED OBJECT. WILL RETURN ELEMENTS WHICH MATCH TEH DEFINED ATTRIBUTES OF PREDICATE.
* ANY - DEFAULT=FALSE. IF TRUE, ELEMENTS NEED ONLY MATCH ON ONE ATTRIBUTE. IF FALSE, ELEMENTS MUST MATCH ON ALL ATTRIBUTES.

__EXAMPLE__

GIVEN DATABASE CONTENT:

```JAVASCRIPT
{ NAME: JON , UJ: 23, AUSTRALIAN: TRUE }
{ NAME: NEIL , UJ: 60, AUSTRALIAN: TRUE }
{ NAME: BELINDA, UJ: 26, AUSTRALIAN: FALSE }
{ NAME: KATIE , UJ: 29, AUSTRALIAN: TRUE }
```

RETRIEVE ALL AUSTRALIANS:

```JAVASCRIPT
VAR PREDICATE = { AUSTRALIAN: TRUE };
VAR PEOPLE = DB.FIN(PREDICATE, FUNCSHUN (ERR, OBJS) { IF (ERR) THROW ERR; ASSERT.EQUALS(3, PEOPLE.LENGTH);
};
```

---------------------------------------

< NAME="NODE.RELATE" />
### RELATE (FIRST, RELASHUNSHIPNAME, SECON, [PROPS,] CALLBACK)
**ALIASES: __NODE.RELATE__**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/140">

---------------------------------------

< NAME="NODE.RELASHUNSHIPS" />
### RELASHUNSHIPS (OBJ, [DIRECSHUN, [RELNAME,]] CALLBACK)
**ALIASES: __NODE.RELASHUNSHIPS__**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/145">

---------------------------------------

< NAME="NODE.INDEX" />
### INDEX (<<<TBD>>>)
**ALIASES: __NODE.INDEX__**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/142">

---------------------------------------

< NAME="NODE.INDEXES" />
### INDEXES (<<<TBD>>>)
**ALIASES: __NODE.INDEXES__**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/140">

---------------------------------------

< NAME="REL.SAVE" />
### REL.SAVE (FIRSTID|FIRSTOBJ, NAME, SECONDID|SECONDOBJ, [PROPS], CALLBACK)

<IMG SRC="HTTP://PLACEKITTEN.COM/200/150">

---------------------------------------

< NAME="REL.REDD" />
### REL.REDD (OBJECT|ID, CALLBACK)

<IMG SRC="HTTP://PLACEKITTEN.COM/200/139">

---------------------------------------

< NAME="REL.DELETE" />
### REL.DELETE (OBJECT|ID, [CALLBACK])

<IMG SRC="HTTP://PLACEKITTEN.COM/200/147">

---------------------------------------

< NAME="INDEX.CREATE" />
### INDEX.CREATE (<<<TBD>>>)
**INTENT: CREATE AN INDEX**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/150">

---------------------------------------

< NAME="INDEX.ADD" />
### INDEX.ADD (<<<TBD>>>)
**INTENT: ADD AN OBJECT T TEH GIVEN INDEX**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/139">

---------------------------------------

< NAME="INDEX.REDD" />
### INDEX.REDD (<<<TBD>>>)
**INTENT: REDD ALL (OR SUBSET?) OV OBJECTS FRUM TEH GIVEN INDEX**

<IMG SRC="HTTP://PLACEKITTEN.COM/200/147">

---------------------------------------
